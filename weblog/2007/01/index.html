<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
		<meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" />
		<title>Dan Wood: The Eponymous Weblog (Archives) | by Dan Wood, Karelia Software</title>
		<meta name="description" content="Useful Tidbits and Egotistical Musings from Dan Wood, co-owner of Karelia Software. This blog mostly covers geeky topics like Mac Programming." />

<link rel="alternate" type="application/rss+xml" title="RSS" href="http://gigliwood.com/weblog/index.rss" />



<style type="text/css">

/* color palette: tinyurl.com/tgq5o */

body {
	background:#9191FF;
	margin:0;
	padding:0;
	font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size:76%;
	word-wrap:break-word;
	}


pre { word-wrap:normal !important;
		font:9px monaco;
		margin-right:-3px;
	background:white; padding: 3px; overflow:auto; }


.bio { font-size:80%; margin:auto; text-align:center; padding:10px 40px; }
.description { clear:all; color:white; font-weight:bold; font-size:120%; margin:auto; text-align:center; }

.categories { text-align:center; border-top:1px dashed #888; border-bottom:1px dashed #888; }

#frame {
	margin-left:auto;
	margin-right:auto;
	padding:0px;
	width:785px;
	overflow:auto;
	margin-bottom:80px;
	}
	
#heady {
	background:#12127D;
	color:#B37D00;
	padding:20px 10px 10px 10px;
}

#heady a:link              { color:#FFB200; text-decoration:underline; }
#heady a:visited           { color:#FFB200; text-decoration:none; }
#heady a:hover             { color:#C8C8FF; text-decoration:underline; }
#heady a:active            { color:#FFFFFF; text-decoration:underline; }

h1, h2, h3, h4 {
	margin:0;
}

h1 {
	padding-bottom:20px;
	font-weight:normal;
	font-family:Zapfino, Georgia, serif;
	text-shadow:white 0 0 20px;
	text-align:center;
}
	
#contentcenter {
	width: 565px;
	}

div.dateHeader {
	text-align:right;
	padding:5px;
	font-weight:bold;
	}

/* holds one item */
div.item {
	background:white;
	overflow:auto;
	}

/* sub-holds one item */
div.row {
  		}

div.row .label {
		float: left;
		width: 105px;
		}
		
p.postinfo {
		text-align: right;
		padding:10px 10px 5px 5px;
		font-size:70%;
		margin:0;
}
		
.label h2 {
	color:#12127D;
	font-size:140%;
	background:#ffB200;
	text-shadow:white 2 0 2px;
	padding:5px;
	margin:0;
	font-family:Georgia, serif;
	font-weight:normal;
}

.label img {
	padding:3px 0;
}

.label a:link              { color:#1919B3; text-decoration:none; }
.label a:visited           { color:#9191FF; text-decoration:none; }
.label a:hover             { color:#12127D; text-decoration:underline; }
.label a:active            { color:#B37D00; text-decoration:underline; }


div.row .value {
		float: left;
		width: 440px;
		text-align: left;
		padding:0 10px 60px 10px;
		background:#FFECBF;
		font-family:Georgia, serif;  font-size:110%;
		}

.value a:link              { color:#1919B3; text-decoration:none; }
.value a:visited           { color:#9191FF; text-decoration:none; }
.value a:hover             { color:#12127D; text-decoration:underline; }
.value a:active            { color:#B37D00; text-decoration:underline; }


#sidebar {
	background:#FFD980;
	width:200px;
	padding:20px 10px 80px 10px;
	height:100%;
	text-align:center;
	float:right;
	font-size:80%;
	}

#sidebar a:link              { color:#1919B3; font-weight:normal; text-decoration:underline; }
#sidebar a:visited           { color:#9191FF; font-weight:bold; text-decoration:none; }
#sidebar a:hover             { color:#12127D; font-weight:bold; text-decoration:underline; }
#sidebar a:active            { color:#B37D00; font-weight:bold; text-decoration:underline; }
	
div.calendar {
}
table.month-calendar {
	margin-left:auto;
	margin-right:auto;
	width:80%;
}

.month-calendar, .year-calendar {
	border-collapse:	collapse; 
}
.month-calendar-head, .year-calendar-head {
	background:		#cccccc;
	font-size:		110%;
	font-weight:		bold;
}
.month-calendar-day-head, .year-calendar-subhead {
	font-weight:		normal;
}

.month-calendar-day-noday,
.month-calendar-day-link,     .year-calendar-month-link,
.month-calendar-day-nolink,   .year-calendar-month-nolink,
.month-calendar-day-this-day, .year-calendar-this-month,
.month-calendar-day-future,   .year-calendar-month-future  {
	text-align:		center;
}

.month-calendar-day-future, .year-calendar-month-future {
	color:			#83660F;
}

.Saturday, .Sunday {
	background:		#eeeeee;
}

.month-calendar-day-this-day, .year-calendar-this-month {
	background:		#a5e4ff;
}

</style>

</head>

<body>
<div id="frame">
	<div id="heady">
		<h1>Dan Wood: The Eponymous Weblog <span style="font-size:70%;">(Archives)</span></h1>
		<p class="bio">
			<img style="float:right; margin-top:-20px; border:2px solid gray;" src="http://gigliwood.com/weblogpix/dan_wood.jpeg
" alt="Dan Wood" height="82" width="49" />
		<i>Dan Wood is co-owner of <a href="http://www.karelia.com/">Karelia Software</a>, creating programs for the Macintosh computer.  He is the father of two kids, lives in the Bay Area of California USA, and prefers bicycles to cars.  This site is his older weblog, which mostly covers geeky topics like Macs and Mac Programming.  <a href="http://gigliwood.com/blog">Go visit the current blog here.</a></i>
		</p>
		<p class="description">Useful Tidbits and Egotistical Musings from Dan Wood</p>
		<p class="categories"> <em>Categories:</em> 
		<a href="../../Business/index.html">Business</a> &middot; 
		<a href="../../MacOSX/index.html">Mac OS X</a> &middot; 
		<a href="../../Cocoa/index.html">Cocoa Programming</a> &middot; 
		<a href="../../General/index.html">General</a> &middot; 
		<a href="../../index.html"><b>All Categories</b></a>
		</p>
	</div>
	<div id="sidebar">
		<h3>Calendar</h3>
		<div class="calendar">
			<table class="month-calendar"><caption class="month-calendar-head"><a title="December 2006 (11)" href="../../2006/12/index.html">&larr;</a><a title="January 2007 (10)" href="index.html">January</a><a title="February 2007 (5)" href="../02/index.html">&rarr;</a></caption>
<tr>
<th class="month-calendar-day-head Sunday">Sun</th>
<th class="month-calendar-day-head Monday">Mon</th>
<th class="month-calendar-day-head Tuesday">Tue</th>
<th class="month-calendar-day-head Wednesday">Wed</th>
<th class="month-calendar-day-head Thursday">Thu</th>
<th class="month-calendar-day-head Friday">Fri</th>
<th class="month-calendar-day-head Saturday">Sat</th>
</tr>
<tr>
<td class="month-calendar-day-noday Sunday">&nbsp;</td>
<td class="month-calendar-day-nolink Monday">1</td>
<td class="month-calendar-day-link Tuesday"><a title="Tuesday, 2 January 2007 (1)" href="02/index.html">2</a></td>
<td class="month-calendar-day-link Wednesday"><a title="Wednesday, 3 January 2007 (1)" href="03/index.html">3</a></td>
<td class="month-calendar-day-nolink Thursday">4</td>
<td class="month-calendar-day-nolink Friday">5</td>
<td class="month-calendar-day-link Saturday"><a title="Saturday, 6 January 2007 (1)" href="06/index.html">6</a></td>
</tr>
<tr>
<td class="month-calendar-day-nolink Sunday">7</td>
<td class="month-calendar-day-nolink Monday">8</td>
<td class="month-calendar-day-nolink Tuesday">9</td>
<td class="month-calendar-day-link Wednesday"><a title="Wednesday, 10 January 2007 (1)" href="10/index.html">10</a></td>
<td class="month-calendar-day-nolink Thursday">11</td>
<td class="month-calendar-day-nolink Friday">12</td>
<td class="month-calendar-day-nolink Saturday">13</td>
</tr>
<tr>
<td class="month-calendar-day-nolink Sunday">14</td>
<td class="month-calendar-day-link Monday"><a title="Monday, 15 January 2007 (1)" href="15/index.html">15</a></td>
<td class="month-calendar-day-nolink Tuesday">16</td>
<td class="month-calendar-day-link Wednesday"><a title="Wednesday, 17 January 2007 (2)" href="17/index.html">17</a></td>
<td class="month-calendar-day-link Thursday"><a title="Thursday, 18 January 2007 (1)" href="18/index.html">18</a></td>
<td class="month-calendar-day-nolink Friday">19</td>
<td class="month-calendar-day-nolink Saturday">20</td>
</tr>
<tr>
<td class="month-calendar-day-nolink Sunday">21</td>
<td class="month-calendar-day-nolink Monday">22</td>
<td class="month-calendar-day-nolink Tuesday">23</td>
<td class="month-calendar-day-nolink Wednesday">24</td>
<td class="month-calendar-day-nolink Thursday">25</td>
<td class="month-calendar-day-link Friday"><a title="Friday, 26 January 2007 (1)" href="26/index.html">26</a></td>
<td class="month-calendar-day-nolink Saturday">27</td>
</tr>
<tr>
<td class="month-calendar-day-link Sunday"><a title="Sunday, 28 January 2007 (1)" href="28/index.html">28</a></td>
<td class="month-calendar-day-nolink Monday">29</td>
<td class="month-calendar-day-nolink Tuesday">30</td>
<td class="month-calendar-day-nolink Wednesday">31</td>
<td class="month-calendar-day-noday Thursday">&nbsp;</td>
<td class="month-calendar-day-noday Friday">&nbsp;</td>
<td class="month-calendar-day-noday Saturday">&nbsp;</td>
</tr>
</table>

		</div>

		<h3><a href="http://amzn.com/w/2663V7TM8IKKC">My Amazon WishList</a></h3>


		<p>Subscribe:
		   <a href="http://gigliwood.com/weblog/index.rss" title="RSS Feed for this category; drag link into a news reader program."><img  src="http://gigliwood.com/weblogpix/rss.gif" alt="RSS" border="0" /></a>
		</p>
		<p>
				<a href="mailto: dan at this domain">Feedback</a></i>
		</p>
		
		<p>
			<b>Also on this website</b>
			<a href="http://gigliwood.com/abcd/">A Basic Course in Dvorak</a> &middot;
			<a href="http://gigliwood.com/kenwood/Pickle/">The Pickle Machine</a> &middot;
			<a href="http://gigliwood.com/mentos/">The Mentos Gallery</a> &middot;
			<a href="http://gigliwood.com/tabletester">Cocoa Table Tester</a> &middot;
			<a href="http://gigliwood.com/wedding">Making your Wedding Make a Difference</a> &middot;
			</p>
		<p>
			<b>Sites I also work on</b>
			<a href="http://www.bikealameda.org/">BikeAlameda</a> &middot;
			<a href="http://progala.blogspot.com/">A Progressive Alamedan (my political blog)</a> &middot;
			<a href="http://www.karelia.com/">Karelia Software</a>
		</p>
		
		<p>
			<b>I'm also here:</b>
			<a href="http://twitter.com/danwood">danwood</a> on Twitter
		</p>
	</div> <!-- end sidebar -->

	<div id="contentcenter">





<div class="dateHeader">Sun, 28 Jan 2007</div>
<div class="item">
	<div class="row">
		<div class="label">
			<h2>File Caching Schemes</h2>
			<p class="postinfo">
				<a href="../../Cocoa/File_Caching_Schemes.html">permanent link</a>
				&middot; Topic<a href="../../Cocoa/">/Cocoa</a>
				<br />
				<a href="../../Cocoa/"><img border="0" src="http://gigliwood.com/weblogpix/Cocoa.gif" alt="/Cocoa" /></a>
				
			</p>
		</div>
		<div class="value"><p>
I recently added an on-disk data cache in order to speeed up a slow aspect of my application.  I've come up with caching solutions before, but I thought I'd take a fresh look at the problem.
</p>
<p>
If you look in the contents of <tt>~/Library/Caches/</tt> you will see that a <em>lot</em> of applications have some sort of cache in there.  It turns out that many of them are actually just generated by <b>NSURLRequest</b>.
</p>
<p>
Figuring that Apple probably has given some thought to cache file organization, I took a close look at the structure of a typical application's cache folder.  
</p>
<p>
A typical cache file sub-path is something like this:
</p>
<p>
<tt>13/02/4281199315-1410279211.cache</tt>
</p>
<p>
It appears that the first two directories are given a name of decimal 00 through 15; the actual file name is comprised of two decimal thirty-two-bit unsigned integers.
</p>
<p>
Therefore, each cache entry is indexed by, essentially, 2^72 or a nine-byte number.  A hash function that reduces to 72 bits is obviously going to have a fair number of collisions, so the cache file needs to store the source URL in the file itself.  I'm guessing that a cache file of this type stores multiple data for each hash value, rather than just punting if a hash doesn't match, but I haven't tried digging into the binary format to confirm this.
</p>
<p>
What I did for my needs was to start out similarly to Apple's approach, creating two levels of directories based on the first eight bits of the hash value.  I'm not that familiar with the intracacies of file systems, but I am guessing that Apple used this technique for a reason.  (If any reader has any further insight on this, I'd be curious to learn more about it in the comments.)
</p>
<p>
For the hashing, I decided to use an SHA1 hash on the source URL, which hashes to 20 bytes (160 bits), <em>way</em> less likely to have a collision than Apple's 72-bit hash.  (So much so, in fact, that I just didn't deal with the possibility of collision; it's not that important.  I just store the actual binary data in the cache file.)  The first byte of the hash determines the two enclosing folders, the last nineteen bytes get converted to hexadecimal for the long file name.  So a typical path looks like this:
</p>
<p>
<tt>05/07/f1e53115eb37b4e4df9e1879bc530daa65666e.tiff</tt>
</p>
<p>
I'm not married to this particular approach; in fact it's not being used in any production code yet.  I'm curious if any readers have come up with similar or different approaches, or even found (or written) a nice API around the notion of cache files.  I'm happy to throw away this technique if somebody else has come up with a better solution!
</p>
<p>
<b>Update:</b> Just to clarify, the reason I'm coming up with my own caching scheme is that the data that I want to cache do not come from URL requests.  They are generated thumbnails of images and quicktime movies.  It would be great if apple exposed something that would allow me to use their system but with my own data.
</p></div>
	</div>
</div>
<div class="dateHeader">Fri, 26 Jan 2007</div>
<div class="item">
	<div class="row">
		<div class="label">
			<h2>Core Graphics, or: How I learned to stop worrying and love CGImageRef</h2>
			<p class="postinfo">
				<a href="../../Cocoa/Core_Graphics,_or__.html">permanent link</a>
				&middot; Topic<a href="../../Cocoa/">/Cocoa</a>
				<br />
				<a href="../../Cocoa/"><img border="0" src="http://gigliwood.com/weblogpix/Cocoa.gif" alt="/Cocoa" /></a>
				
			</p>
		</div>
		<div class="value"><p>
I'm a big fan of <b>Core Image</b>; I blogged (<a href="http://gigliwood.com/weblog/Cocoa/Core_Image__Practic.html">1</a>, <a href="http://gigliwood.com/weblog/Cocoa/Core_Image,_part_2.html">2</a>) about quite a while ago.  And I like <b>NSImage</b> for its simplicity.  But only recently have I been introduced to Core Graphics.  I wish I had been aware of its coolness much earlier!
</p>
<p>
This came up recently when I met <a href="http://stuntblog.com/">Dan</a> of <a href="http://www.stuntsoftware.com/">Stunt Software</a> recently at <a href="http://www.macworldexpo.com/">Macworld Expo</a>.  He has an application that shows thumbnails of images.  He mentioned that he had tried <a href="http://www.enlightenment.org/Libraries/Epeg/">Epeg</a>, which Sandvox has been using to quickly generate thumbnails from JPEG images, but found that Core Graphics has a much faster technique: specifically the function <b>CGImageSourceCreateThumbnailAtIndex</b>.
</p>
<p>
I started to look into this, and came across a <a href="http://wilshipley.com/blog/2005/09/jpeg2000-cool-but-slow.html">blog post by Wil Shipley</a> that mentioned how fast CG was at doing thumbnails.  I had actually read this, but didn't pay too much attention back then!  I probably avoided CG because it doesn't have a nice Cocoa-like interface to it.  My loss!
</p>
<p>
I bit the bullet and started to convert some of our code, starting with the thumbnailing in the media browser, to use this technique.  Wow, what a speedup! And I actually can go further: all I'm doing now is building the thumbnail and then converting the CGImageRef to an NSImage for <a href="http://www.blakeseely.com/downloads.html">MUPhotoView</a> to draw.  But I can go further if I modify MUPhotoView to natively deal with the CGImageRef instead of NSImage.  That will be my next step, but it will be a bit more work.
</p>
<p>
Here are some snippets of code (Tiger-only).  The first is to read from a file and create a thumbnail.
</p>
<pre>
NSURL *url = [NSURL fileURLWithPath:imagePath];
CGImageSourceRef source = CGImageSourceCreateWithURL((CFURLRef)url,NULL);
if (source)
{
  NSDictionary* thumbOpts = [NSDictionary dictionaryWithObjectsAndKeys:
  (id)kCFBooleanTrue, (id)kCGImageSourceCreateThumbnailWithTransform,
  (id)kCFBooleanTrue, (id)kCGImageSourceCreateThumbnailFromImageIfAbsent,
  [NSNumber numberWithInt:MAX_THUMB_SIZE],
        (id)kCGImageSourceThumbnailMaxPixelSize, 
    nil];
  
  CGImageRef theCGImage = CGImageSourceCreateThumbnailAtIndex(
    source, 0, (CFDictionaryRef)thumbOpts);
   ...
    CFRelease(theCGImage);
  }
  CFRelease(source);
}
</pre>
<p>
To convert the CGImage to an NSImage, I used this code.  I had to flip the image, in my situation, to make the image draw properly.
</p>
<pre>
NSRect imageRect = NSZeroRect;
CGContextRef imageContext = nil;

imageRect.size.height = CGImageGetHeight(theCGImage);
imageRect.size.width = CGImageGetWidth(theCGImage);

img = [[[NSImage alloc] initWithSize:imageRect.size] autorelease];
[img setFlipped:YES];
[img lockFocus];
imageContext = (CGContextRef)
    [[NSGraphicsContext currentContext] graphicsPort];
CGContextDrawImage(imageContext, *(CGRect*)&imageRect, theCGImage);
[img unlockFocus];
</pre></div>
	</div>
</div>
<div class="dateHeader">Thu, 18 Jan 2007</div>
<div class="item">
	<div class="row">
		<div class="label">
			<h2>Screen Mimic 2.0</h2>
			<p class="postinfo">
				<a href="../../MacOSX/Screen_Mimic_2.0.html">permanent link</a>
				&middot; Topic<a href="../../MacOSX/">/MacOSX</a>
				<br />
				<a href="../../MacOSX/"><img border="0" src="http://gigliwood.com/weblogpix/MacOSX.gif" alt="/MacOSX" /></a>
				
			</p>
		</div>
		<div class="value"><p>
I hadn't heard of this <a href="http://www.polarian.com/products/ScreenMimic.php">Screen Mimic</a> before today, but the timing is perfect &mdash; I was just wishing for an application like this <i>yesterday</i>.  I am often in the need to make up a quick little screencast (of course not as polished as the <a href="http://www.karelia.com/screencast.html">Sandvox demo</a>) with live voice recording, so I can explain what I'm doing on my Mac.
</p>
<p>
This is a really slick, useful program.  I can record a fixed area or have the window follow my mouse.  My clicks and my drags can be superimposed (with a little circle) so it's clearer what I'm doing.  (Maybe it needs the ability to also indicate that with sound effects!)
</p>
<p>
What's really cool is that its author, Lee Falin, was <a href="http://www.leefalin.com/2005/12/12/how-i-got-started-in-cocoa-programming/">inspired to become an indie Mac developer</a> after hearing a panel that I put together at an O'Reilly Mac OS X conference.  (Oliver Breidenbach <a href="http://www.oreillynet.com/mac/blog/2007/01/lee_falin_how_i_got_started_in.html?CMP=OTC-13IV03560550&amp;ATT=Lee+Falin+How+I+got+started+in+Cocoa+Programming">mentioned this today</a> over on MacDevCenter.)
</p>
</div>
	</div>
</div>
<div class="dateHeader">Wed, 17 Jan 2007</div>
<div class="item">
	<div class="row">
		<div class="label">
			<h2>Person Merging</h2>
			<p class="postinfo">
				<a href="../../General/Person_Merging.html">permanent link</a>
				&middot; Topic<a href="../../General/">/General</a>
				<br />
				<a href="../../General/"><img border="0" src="http://gigliwood.com/weblogpix/General.gif" alt="/General" /></a>
				
			</p>
		</div>
		<div class="value"><p>
I like to work down at a nearby caf&eacute; one day a week or so, just for a change of pace, and to try to emulate the behavior of famous software companies. <tt>:-)</tt>  Recently I started chatting with another patron there when I noticed that he stopped bringing in a Windows laptop and was now using a Mac.  I learned his first name, and over the last couple of months, we've chatted at bit when we run into each other there.
</p>
<p>
Meanwhile, I've been corresponding with a fellow Alameda resident over the last couple of months; he has started up a local political group that I've been hoping to get involved with &mdash; but haven't yet.
</p>
<p>
Yesterday I discovered that those two people &mdash; the guy at the caf&eacute; and the guy I've been exchanging emails with &mdash;&#160;are the same person!
</p>
<p>
What a strange thing to happen, to have to now merge two "people" (in my mental model of the world) into one!
</p>
</div>
	</div>
</div>
<div class="item">
	<div class="row">
		<div class="label">
			<h2>Generating Standard Objects from Core Data Models</h2>
			<p class="postinfo">
				<a href="../../Cocoa/Generating_Standard.html">permanent link</a>
				&middot; Topic<a href="../../Cocoa/">/Cocoa</a>
				<br />
				<a href="../../Cocoa/"><img border="0" src="http://gigliwood.com/weblogpix/Cocoa.gif" alt="/Cocoa" /></a>
				
			</p>
		</div>
		<div class="value"><p>
I recently had the occasion to create a number of cocoa classes.  These ones were <i>not</i> using Core Data, but I thought it would be cool to make use of XCode's modeling tools and build up my objects as a Core Data model.
</p>
<p>
To accomplish this, I first ran across Jonathan 'Wolf' Rentzsch's <a href="http://rentzsch.com/code/mogenerator_v1.1">mogenerator</a> (installing by following this <a href="http://www.pyrusmalus.com/blog/archives/2007/01/03/mogenerator_v1_1.html">excellent tutorial</a>).
</p>
<p>
mogenerator is little program that analyzes your data model and spits out classes (in two halves, a machine-generated part and a developer-modifiable part).  But the classes that are generated are intended to be <b>NSManagedObject</b> subclasses, which I didn't want.
</p>
<p>
So I rebuilt the template files (which you install into <tt>~/Library/Application Support/mogenerator/</tt>) to build instance variables, more standard accessors, an init and dealloc method, and so forth.
</p>
<p>
These files are available for download <a href="http://gigliwood.com/weblogfiles/mogenerator_files.zip">here</a>. If you use it, you might want to modify these further, to change the accessor styles, replace <b>NSMutableSet</b> with <b>NSMutableArray</b>, and so forth. But it might be a useful start for your project.
</p>
</div>
	</div>
</div>
<div class="dateHeader">Mon, 15 Jan 2007</div>
<div class="item">
	<div class="row">
		<div class="label">
			<h2>Karelia Software Announces the iPhone Developer's Kit</h2>
			<p class="postinfo">
				<a href="../../MacOSX/Karelia_Software_An.html">permanent link</a>
				&middot; Topic<a href="../../MacOSX/">/MacOSX</a>
				<br />
				<a href="../../MacOSX/"><img border="0" src="http://gigliwood.com/weblogpix/MacOSX.gif" alt="/MacOSX" /></a>
				
			</p>
		</div>
		<div class="value"><p>
OK, just kidding.  This post is actually a recap of last week's Macworld Expo activity.
</p>
<p>
The headline is a joke that I came up with at the "Mac Small Business" gathering last Wednesday.  Fellow developers and the few Apple employees there appreciated the idea that maybe if Karelia software announced a developer's kit, then Apple would be quick to get one released.  :-)
</p>
<p>
The iPhone-lacking-a-developer's kit issue has become a big issue on the internets; I'm glad I'm not alone in wishing that one could develop software for it.  That's what I do for a living, and the iPhone is a droolworthy mini-micro-computer that is just begging for third-party add-ons.
</p>
<p>
In any case, the iPhone may have been big news, but it only a tiny part of my week.  I arrived at the Expo on Wednesday; immediately before entering I bumped into StuFF mc of <a href="http://www.pomcast.com/">Pomcast</a>; he had interviewed us a while back about Sandvox.  I then spent most of the day wandering around the booths.  One of the best activities on the show floor is running into old friends, many from my days working with BMUG in the early days of the Macintosh.  I checked out the booths run by developers whom I know; many like <a href="http://www.memoryminer.com/">MemoryMiner</a> were at small "pod" booths and a few, like <a href="http://plasq.com/">Plasq</a>, had a larger setup.  (I find that the large booths run by the big companies are usually much less interesting than to the smaller ones run by small companies!)
</p>
<p>
Wednesday evening, there were three events I wanted to go to.  I was scheduled to do a demonstration of Sandvox at a BoF (Birds-of-a-Feather) gathering hosted by <a href="http://www.dori.com/">Dori Smith</a>.  Alas, the video projection equipment had been taken away.  So I headed over to the aforementioned Mac Small Business gathering, which was a great opportunity to connect and re-connect with fellow developers who also wear the business-owner hat.  One of my more interesting conversations was with Paul of <a href="http://rogueamoeba.com/">Rogue Amoeba</a>, who had organized the very successful <a href="http://macsanta.com/">MacSanta</a> event a few weeks ago.  After that petered out, I went literally around the corner to another restaurant to spend some time with some other friends who had a big gathering there.
</p>
<p>
Friday, I headed back into San Francisco for more fun.  I had a lunch meeting scheduled with a well-known User Interface Guru from Apple to pick his brain and get ideas for the UI of the next generation of our application.  We got a bit sidetracked, and instead he picked <i>my</i> brain about how can Apple's developer program be improved, including its website and developer conference.  It was fun to provide constructive feedback and brainstorm some ideas.  We ran out of time before we could talk about User Interface, so we'll have to set up another meeting down the road.
</p>
<p>
After lunch, I wandered around some of the "pods" that I had missed on Wednesday.  On <a href="http://www.inessential.com/2007/01/10.php">Brent's recommendation</a>, I visited Dan of <a href="http://www.stuntsoftware.com/">Stunt Software</a>.  Some very nice stuff from a small shop!  I also stumbled upon a cool-looking offsite backup utility called <a href="http://www.crashplan.com/">CrashPlan</a> when <a href="http://www.zocalocoffeehouse.com/">Tim</a> beckoned me over.  This is an application that looks like it is going somewhere (and will probably double its usefulness when Leopard, with its "Time Machine" capabilities, is available).
</p>
<p>
Overall, it was a good expo, and even though the SteveNote didn't have any Macintosh content to it, it's clear from the expo floor that the Macintosh software industry is alive and well.
</p>
</div>
	</div>
</div>
<div class="dateHeader">Wed, 10 Jan 2007</div>
<div class="item">
	<div class="row">
		<div class="label">
			<h2>iPhone ... YAAAWWWWWNNN if you can't develop for it</h2>
			<p class="postinfo">
				<a href="../../MacOSX/iPhone_..._YAAAWWWW.html">permanent link</a>
				&middot; Topic<a href="../../MacOSX/">/MacOSX</a>
				<br />
				<a href="../../MacOSX/"><img border="0" src="http://gigliwood.com/weblogpix/MacOSX.gif" alt="/MacOSX" /></a>
				
			</p>
		</div>
		<div class="value"><p>
<img src="http://gigliwood.com/weblogpix/iphone_in_jail.jpg" style="float:right; padding:0 0 10px 10px;" />
Yes, that's right.  YAAAWWWWWNNN to the iPhone.
</p>
<p>
Sure, it has nice eye candy, and you can do a lot with it.  But it isn't that different from a lot of the other over-functional cellphone/PDA/Camera combinations out there as far as what it can do.
</p>
<p>
What would set it apart would be if one could develop software for it in Cocoa.  But apparently that's not in Apple's plans.  From <a href="http://www.macintouch.com/specialreports/sf2007/">Macintouch</a>:
</p>
<blockquote>
The only two iPhones at the show were under glass, and Apple representatives said it is a "closed platform", refusing even to identify the specific processor it uses, and there's apparently no developer kit for it, though "developers who want to do applications [for the iPhone] are welcome to contact Apple developer relations."
</blockquote>
<p>
If they are really going to make this a closed-platform appliance, then I really do understand why they are not longer "Apple Computer, Inc."  It would be the nail on the coffin for Mac OS X as a computer platform.  If they are not going to open up the iPhone for development, then they might as well take the next logical step and release their next set of iMacs to also be appliances that one cannot develop software for.  With iLife and Dashboard pre-installed, who needs anything else?  Though this is a bit of a hyperbole, that seems to be the attitude.
</p>
<p>
Me?  I'm going to be <a href="http://developer.apple.com/contact/">contacting Apple developer relations</a> and giving them my perspective.  Perhaps I'm not the only developer who would like to come up with some cool software for this little gadget, and if enough people express their interest in writing software for the device, maybe Apple will change their tune and we'll be learning all about it at WWDC 2007.
</p>
<p><b>Update:</b> <a href="http://rentzsch.com/cocoa/iphoneIndieAppDevelopment">Wolf suggests we file a bug report</a>.  Good plan.
</p></div>
	</div>
</div>
<div class="dateHeader">Sat, 06 Jan 2007</div>
<div class="item">
	<div class="row">
		<div class="label">
			<h2>Collecting the user's email addresses</h2>
			<p class="postinfo">
				<a href="../../Cocoa/Collecting_the_user.html">permanent link</a>
				&middot; Topic<a href="../../Cocoa/">/Cocoa</a>
				<br />
				<a href="../../Cocoa/"><img border="0" src="http://gigliwood.com/weblogpix/Cocoa.gif" alt="/Cocoa" /></a>
				
			</p>
		</div>
		<div class="value"><p>
In a few places in Sandvox, we want the user to be able to specify his/her email address.  So we make this easy by collecting a number of possible email addresses they might use and presenting them in a combo box.  The user can then pick one of those, or hand-enter a different address if desired.
</p>
<p>
For today's episode, I thought I'd share the logic we use for collecting those addresses. We collect the possible addresses from three places, adding the addresses to a mutable set.  We also try to determine the primary address, meaning the address most likely to be the one the user will choose.
</p>
<pre>
NSMutableSet *emails = [NSMutableSet set];
NSString *primaryAddress = nil;
</pre>
<p>
First off, we look in the address book's "me" card.  The first address listed there will probably be the primary address.
</p>
<pre>
ABMultiValue *meAddresses = [[[ABAddressBook sharedAddressBook] me]
    valueForProperty:kABEmailProperty];
int i;
for (i = 0 ; i < [meAddresses count] ; i++)
{
    NSString *thisAddress = [meAddresses valueAtIndex:i];
    [emails addObject:thisAddress];
    if (nil == primaryAddress)
    {
        primaryAddress = thisAddress;
    }
}
</pre>
<p>
Next, we look in Apple Mail for some more addresses you might use, and merge them into the set.  We look in all the active accounts and get the address or addresses associated with each.  If we don't have a primary address yet, set it from the first address you find here.
</p>
<pre>
NSMutableArray* mailAccounts
    = (NSMutableArray*) CFPreferencesCopyAppValue(
        (CFStringRef) @"MailAccounts",
        (CFStringRef) @"com.apple.mail");
[mailAccounts autorelease];
NSEnumerator *theEnum = [mailAccounts objectEnumerator];
NSDictionary *accountDict;

while (nil != (accountDict = [theEnum nextObject]) )
{
    BOOL isActive = YES;
    NSString *isActiveValue = [accountDict objectForKey:@"IsActive"];
    if (nil != isActiveValue)
    {
        isActive = [isActiveValue intValue];
    }
    if (isActive)
    {
        NSArray *emailAddresses
            = [accountDict objectForKey:@"EmailAddresses"];
        if ([emailAddresses count])
        {
            [emails addObjectsFromArray:emailAddresses];
            if (nil == primaryAddress)
            {
                primaryAddress = [emailAddresses objectAtIndex:0];
            }
        }
    }
}
</pre>
<p>
The last place to look is your .mac account.  If you have a .mac account, then you have a mac.com email address.
</p>
<pre>
NSString *iToolsMember = [[NSUserDefaults standardUserDefaults]
    objectForKey:@"iToolsMember"];
if (nil != iToolsMember)
{
    NSString *iToolsAddr = [NSString stringWithFormat:
        @"%@@mac.com",iToolsMember];
    [emails addObject:iToolsAddr];
    if (nil == primaryAddress)
    {
        primaryAddress = iToolsAddr;
    }
}
</pre>
<p>
That's all that you need.  I suppose if I wanted I could also look in account lists for Entourage, Eudora, etc. but I don't have that information, and it might not be worth the trouble.
</p>
</div>
	</div>
</div>
<div class="dateHeader">Wed, 03 Jan 2007</div>
<div class="item">
	<div class="row">
		<div class="label">
			<h2>How to upgrade your iPod to 40GB</h2>
			<p class="postinfo">
				<a href="../../General/How_to_upgrade_your.html">permanent link</a>
				&middot; Topic<a href="../../General/">/General</a>
				<br />
				<a href="../../General/"><img border="0" src="http://gigliwood.com/weblogpix/General.gif" alt="/General" /></a>
				
			</p>
		</div>
		<div class="value"><img align="right" src="http://gigliwood.com/weblogpix/ipodpink.gif" />
<p>
OK, it doesn't involve any hard-drive swapping or deal-making with Apple.  Here's how I've upgraded to a 40 GB iPod -- I bought a new iPod, and I'm <a href="http://cgi.ebay.com/ws/eBayISAPI.dll?ViewItem&item=3063821379">selling my 30GB iPod on eBay</a>.  
</p>
<p>
Actually, what I'm selling is almost completely new -- I had taken in my 30Gigger into the Apple Store because it was having a few problems (e.g. it was narcoleptic, falling asleep while playing music, even while docked).  They swapped it for a brand new unit.  But since it was so new, I thought this was a good time to "upgrade" to 40 GB, so I could sell the almost-new 30-gigger.
</p>
<p>
And it still doesn't hold my <i>entire</i> music collection.  (I was an eMusic member for a while; it's amazing how much you can accumulate!)
</p>
<p>
If anybody wants to buy this iPod, which has all the accessories still wrapped up, since I just swapped them with the new stuff that came with the 40-gigger, I'll throw in a license to Watson to the lucky winner! 
</p></div>
	</div>
</div>
<div class="dateHeader">Tue, 02 Jan 2007</div>
<div class="item">
	<div class="row">
		<div class="label">
			<h2>LazyWeb Recruiting Tool again: Help with Tech Support</h2>
			<p class="postinfo">
				<a href="../../Cocoa/LazyWeb_Recruiting_.html">permanent link</a>
				&middot; Topic<a href="../../Cocoa/">/Cocoa</a>
				<br />
				<a href="../../Cocoa/"><img border="0" src="http://gigliwood.com/weblogpix/Cocoa.gif" alt="/Cocoa" /></a>
				
			</p>
		</div>
		<div class="value"><p>
I've had wonderful success so far with using this blog as a way to reach out to the Mac community to look for contractors and partners I can work with on Karelia projects.
</p>
<p>
So as my first post for the new year, I wanted to put out some feelers to see if there is somebody who would be interesting in help out Karelia by doing first-line technical support for Sandvox: reading incoming inquiries, responding if needed, helping users troubleshoot or find the answers in the online help, assigning as bug reports if needed, and so forth.  This would be a part-time task, with compensation structure negotiable.
</p>
<p>
Obviously, somebody who is familiar with Sandvox, and the Mac in general, is going to be best qualified, also good people skills (over email, possibly chat) is important as well.
</p>
<p>
If interested, please email a mac-focused r&eacute;sum&eacute; and cover email to me.  The best way to get past the spam filters is to send it to dan____  (where the blanks are replaced by the current year -- happy new year, of course) at the domain of karelia.com ....
</p>
 </div>
	</div>
</div>
	</div> <!-- end contentCenter -->
</div> <!-- end frame -->

</body>
</html>

