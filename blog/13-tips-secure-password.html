<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<script type="text/javascript">
		  (function() {
		    var config = {
		      kitId: 'fwg6fzg',
		      scriptTimeout: 3000
		    };
		    var h=document.getElementsByTagName("html")[0];h.className+=" wf-loading";var t=setTimeout(function(){h.className=h.className.replace(/(\s|^)wf-loading(\s|$)/g," ");h.className+=" wf-inactive"},config.scriptTimeout);var tk=document.createElement("script"),d=false;tk.src='//use.typekit.net/'+config.kitId+'.js';tk.type="text/javascript";tk.async="true";tk.onload=tk.onreadystatechange=function(){var a=this.readyState;if(d||a&&a!="complete"&&a!="loaded")return;d=true;clearTimeout(t);try{Typekit.load(config)}catch(b){}};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(tk,s)
		  })();
		</script>		<title>13 Tips, Summarized, on Setting up a Secure, Resettable Password Database | Dan Wood: The Eponymous Blog</title>
		<meta name="robots" content="all" />
		<meta name="generator" content="Sandvox 2.10.3" />
		<meta name="viewport" content="width=760" />
		<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
		<link rel="canonical" href="http://gigliwood.com/blog/13-tips-secure-password.html" />
		
		<script>
		WebFontConfig={google:{families:["Droid Serif",]},timeout:3e3};(function(){document.documentElement.className='wf-loading';var e=document.createElement('script');e.src=('https:'==document.location.protocol?'https':'http')+'://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';e.type='text/javascript';e.async='true';var t=document.getElementsByTagName('script')[0];t.parentNode.insertBefore(e,t);window.setTimeout(function(){if((' '+document.documentElement.className+' ').indexOf(' wf-active ')<0){document.documentElement.className='wf-punt'}},3e3)})()
		</script>
		<link rel="stylesheet" type="text/css" href="sandvox_SlateManifest_green/main.css" title="Slate Manifest Green" /><!--[if lt IE 6]>
		<link rel="stylesheet" type="text/css" href="sandvox_SlateManifest_green/ie.css" /><![endif]-->
		<!--
		Photo credits for this website's design: <http://gigliwood.com/blog/sandvox_SlateManifest_green/Credits.rtf>
		Licensing for this website's design:     <http://gigliwood.com/blog/sandvox_SlateManifest_green/License.rtf>
		-->
		
		<script type="text/javascript">
		
		  var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-40201594-1']);
		  _gaq.push(['_trackPageview']);
		
		  (function() {
		    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();
		
		</script>
	</head>
	<body class="sandvox has-page-title no-sidebar no-custom-banner no-navigation no-IR" id="gigliwood_com" >
				<div id="page-container">
			<div id="page">
				<div id="page-top" class="has-logo has-title has-tagline">
					<div id="title">
						<a href="./" class="imageLink"><span id="logo-container"><img id="logo" src="_Media/imgp3949jpg_med_hr.jpeg" alt="IMGP3949.JPG" width="105" height="105" /></span></a>
						<h1 class="title in"><a href="./"><span class="in">Dan Wood: The Eponymous Blog<br /></span></a></h1>
						<p id="tagline"><span class="in"><span style="font-size: 12px; font-family: Georgia;">Dan Wood is president of Karelia Software, creators of the </span><a href="http://www.karelia.com/sandvox/" style="font-family: Georgia; font-size: 12px;">Sandvox website builder for the Mac</a><span style="font-size: 12px; font-family: Georgia;">. He is the father of two kids, lives in the Bay Area of California USA, keeps bees in the back yard, volunteers with his kids’ theatre company, and prefers bicycles to cars. This site is his new blog, which mostly covers geeky topics like Macs and Mac Programming. (Visit the </span><a href="http://gigliwood.com/weblog/" style="font-family: Georgia; font-size: 12px;">older blog</a><span style="font-size: 12px; font-family: Georgia;">.) </span><em style="font-family: Georgia; font-size: 12px;"><a href="https://twitter.com/danwood">Twitter</a></em><br /></span></p>
					</div><!-- title -->
					<div id="sitemenu-container">
						
					</div> <!-- sitemenu-container -->
				</div> <!-- page-top -->
				<div class="clear below-page-top"></div>
				<div id="page-content" class="no-navigation">
					<div id="main">
						<div id="main-top"></div>
						<div id="main-content">
							<h2 class="title"><span class="in">13 Tips, Summarized, on Setting up a Secure, Resettable Password Database</span></h2>
							<div class="article">
								<div class="article-content">
									<div class="RichTextElement">
										<div><p>Today I ran across an awesome blog post from earlier this year on web database security: "<a href="http://www.troyhunt.com/2012/05/everything-you-ever-wanted-to-know.html">Everything you ever wanted to know about building a secure password reset feature</a>."</p><p>Since reading online tales of some of the horrible things that crackers have been able to do to get to people's account information, I thought that this was a fascinating set of guidelines on building a database of users and passwords the right way.</p><p>The original article is worth a read, especially if you are working on any database of users, but it's a long read. Here is my brief summary for your convenience (and perhaps someday for my future reference):</p><ol><li>In your database, store passwords as a one-way hash with a salt that is also stored in the table.</li><li>Don't send the user's password to them.  (Doing the above will obviate that.)</li><li>If user requests a password reset, send an email regardless of whether that email is associated with an account.  (If it's not an account email, you can tell them that in the email, NOT on the web page.)</li><li>In the password reset mail, send a time-limited URL with a unique code that allows them to go in and set a new password; do NOT send a new password. (See point 2).</li><li>Consider using a CAPTCHA on a password reset form if automated attacks are an issue.</li><li>To avoid problems where somebody's email is compromised, a password reset might contain secret questions.  If you do this, make sure that they are concise, specific, diverse, hard to discover, and constant over time.</li><li>Secret answers should be stored encrypted in the database. (Hashes are problematic if they need to be verified by a person.)</li><li>Consider two-factor authentication.</li><li>Do not allow password reset via username, only email address</li><li>In your password reset emails, indicate the IP address of where the reset request came from.</li><li>Notify the account owner via email when account information is changed.</li><li>Do lots of logging (but without sensitive information) to help uncover malicious behavior.</li><li>Do not lock out the old password from working until the new password information is completely verified.</li></ol><p>All in all, a good overview. Hopefully more and more account providers follow this kind of advice — I cringe when I see my password sent to me over email in clear text!</p></div>
									</div>
								</div> <!-- /article-content -->
								<div class="article-info">
															<!-- comments -->
															
															
						                                    <div id="disqus_thread"></div>
						                                    
															
															
															<!-- comments -->		</div> <!-- /article-info -->
							</div> <!-- /article -->
						</div> <!-- main-content -->
						<div id="main-bottom"></div>
					</div> <!-- main -->
				</div> <!-- content -->
				<div class="clear below-content"></div>
				<div id="page-bottom">
					<div id="page-bottom-contents">
						<div>© Dan Wood 2012-2016. <a href="comments-policy.html">My Comments Policy</a></div>
						<div class="hidden"> <a rel="nofollow" href="#title">[Back To Top]</a></div>
					</div>
				</div> <!-- page-bottom -->
			</div> <!-- container -->
			<div id="extraDiv1"><span></span></div><div id="extraDiv2"><span></span></div><div id="extraDiv3"><span></span></div><div id="extraDiv4"><span></span></div><div id="extraDiv5"><span></span></div><div id="extraDiv6"><span></span></div>
		</div> <!-- specific body type -->
		<script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-1.9.1.min.js"></script>
		<script>
		if (typeof jQuery === 'undefined') document.write('<scr'+'ipt src="_Resources/jquery-1.9.1.min.js"></scr'+'ipt>');
		</script>
		
		<script>
		var disqus_shortname = 'danwood';
		var disqus_url = 'http://gigliwood.com/blog/13-tips-secure-password.html';
		var disqus_title = '13 Tips, Summarized, on Setting up a Secure, Resettable Password Database';
		(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.charset = 'utf-8';
		dsq.src = '//danwood.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
		</script>
		
	</body>
</html>